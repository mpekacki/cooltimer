(this.webpackJsonptimer=this.webpackJsonptimer||[]).push([[0],{20:function(t,e,s){},29:function(t,e,s){},35:function(t,e,s){"use strict";s.r(e);var n=s(2),a=s.n(n),r=s(7),i=s.n(r),o=(s(20),s(13)),c=s(3),l=s(4),d=s(6),h=s(5),u=s(12),k=(s(29),s(1)),m=function(t){Object(d.a)(s,t);var e=Object(h.a)(s);function s(t){var n;return Object(c.a)(this,s),(n=e.call(this,t)).componentWillReceiveProps=function(t){n.setState(t)},n.onChangeWorkMinutes=function(t){n.onchange({workMinutes:t.target.value})},n.onChangeShortBreakMinutes=function(t){n.onchange({shortBreakMinutes:t.target.value})},n.onChangeLongBreakMinutes=function(t){n.onchange({longBreakMinutes:t.target.value})},n.onChangeLongBreakFreq=function(t){n.onchange({longBreakFreq:t.target.value})},n.state={workMinutes:t.workMinutes,shortBreakMinutes:t.shortBreakMinutes,longBreakMinutes:t.longBreakMinutes,longBreakFreq:t.longBreakFreq},n.onchange=t.onchange,n}return Object(l.a)(s,[{key:"render",value:function(){return Object(k.jsxs)("div",{children:[Object(k.jsxs)("div",{class:"d-flex flex-row form-group",children:[Object(k.jsx)("label",{htmlFor:"work-minutes",class:"p-2 col-form-label",children:"Work cycle minutes"}),Object(k.jsx)("div",{class:"p-2",children:Object(k.jsx)("input",{class:"form-control",type:"number",value:this.state.workMinutes,onChange:this.onChangeWorkMinutes,id:"work-minutes"})})]}),Object(k.jsxs)("div",{class:"d-flex flex-row form-group",children:[Object(k.jsx)("label",{htmlFor:"short-break-minutes",class:"p-2 col-form-label",children:"Short break minutes"}),Object(k.jsx)("div",{class:"p-2",children:Object(k.jsx)("input",{class:"form-control",type:"number",value:this.state.shortBreakMinutes,onChange:this.onChangeShortBreakMinutes,id:"short-break-minutes"})})]}),Object(k.jsxs)("div",{class:"d-flex flex-row form-group",children:[Object(k.jsx)("label",{htmlFor:"long-break-minutes",class:"p-2 col-form-label",children:"Long break minutes"}),Object(k.jsx)("div",{class:"p-2",children:Object(k.jsx)("input",{class:"form-control",type:"number",value:this.state.longBreakMinutes,onChange:this.onChangeLongBreakMinutes,id:"long-break-minutes"})})]}),Object(k.jsxs)("div",{class:"d-flex flex-row form-group",children:[Object(k.jsx)("label",{htmlFor:"long-break-freq",class:"p-2 col-form-label",children:"Long break after n cycles"}),Object(k.jsx)("div",{class:"p-2",children:Object(k.jsx)("input",{class:"form-control",type:"number",value:this.state.longBreakFreq,onChange:this.onChangeLongBreakFreq,id:"long-break-freq"})})]})]})}}]),s}(a.a.Component),g=function(t){Object(d.a)(s,t);var e=Object(h.a)(s);function s(t){var n;return Object(c.a)(this,s),(n=e.call(this,t)).onClickStartWorking=function(){n.setStateAndStorage({isWork:!0,timerRunning:!0}),n.markTimerStart(n.props.timerSeconds,Date.now())},n.onClickReturnToWork=function(){var t=n.props.timerSeconds,e=60*n.props.workMinutes;n.setStateAndStorage({isWork:!0,timerSeconds:e}),n.notifyCycleChange(!1,t,e)},n.onClickGoOnABreak=function(){var t=Math.round(n.props.availableBreakSeconds),e=n.props.timerSeconds;n.setStateAndStorage({isWork:!1,timerSeconds:t,availableBreakSeconds:t}),n.notifyCycleChange(!0,e,t)},n.tick=function(){if(n.props.timerRunning){var t=Date.now(),e=Math.round((t-n.props.timerLastUpdatedAt)/1e3);n.tempState={isWork:n.props.isWork,totalWorkedSeconds:n.props.totalWorkedSeconds,availableBreakSeconds:n.props.availableBreakSeconds,hiddenAvailableBreakSeconds:n.props.hiddenAvailableBreakSeconds,timerLastUpdatedAt:n.props.timerLastUpdatedAt,cycle:n.props.cycle,continousWork:n.props.continousWork,timerSeconds:n.props.timerSeconds};for(var s=e;s>0;s--){if(n.tempState.timerSeconds--,n.tempState.isWork){n.tempState.totalWorkedSeconds++;var a=1*n.props.shortBreakMinutes/n.props.workMinutes;n.tempState.availableBreakSeconds>=60*n.props.shortBreakMinutes?n.tempState.availableBreakSeconds+=a:n.tempState.hiddenAvailableBreakSeconds+=a}else n.tempState.availableBreakSeconds--;n.tempState.timerLastUpdatedAt=t,0===n.tempState.timerSeconds&&n.onTimerFinish()}n.setStateAndStorage(n.tempState)}else n.setStateAndStorage({timerLastUpdatedAt:Date.now()})},n.onTimerFinish=function(){var t=n.tempState.isWork,e={};if(t){var s,a,r=n.tempState.cycle+1,i=n.tempState.availableBreakSeconds;r===n.props.longBreakFreq&&(r=0,i+=60*n.props.longBreakMinutes-60*n.props.shortBreakMinutes),i+=n.tempState.hiddenAvailableBreakSeconds,i=Math.round(i),n.tempState.continousWork?(s=60*n.props.workMinutes,a=!0):(s=i,a=!1),e={timerSeconds:s,availableBreakSeconds:i,hiddenAvailableBreakSeconds:0,isWork:a,cycle:r}}else e={timerSeconds:60*n.props.workMinutes,isWork:!0};e.timerRunning=n.props.autoStartTimers;var o=n.tempState.timerSeconds;n.tempState=Object.assign(n.tempState,e),n.props.showNotification(t?"Work finished":"Break finished"),n.notifyCycleChange(t,o,n.tempState.timerSeconds)},n.notifyCycleChange=function(t,e,s){var a=n.props.timerStartedAt+1e3*(n.props.timerStartedWithSeconds-e),r={wasWork:t,start:n.props.timerStartedAt,end:a};n.props.onTimerFinish(r),n.markTimerStart(s,a)},n.markTimerStart=function(t,e){var s={timerStartedAt:e,timerStartedWithSeconds:t};n.props.setStateAndStorage(s)},n.onClickHoldWork=function(){n.setStateAndStorage({timerRunning:!1}),n.notifyCycleChange(n.props.isWork,n.props.timerSeconds,n.props.timerSeconds)},n.onClickResumeWork=function(){n.setStateAndStorage({timerRunning:!0}),n.markTimerStart(n.props.timerSeconds,Date.now())},n.onChangeContinousWork=function(t){n.setStateAndStorage({continousWork:t.target.checked})},n.onChangeAutoStartTimers=function(t){n.setStateAndStorage({autoStartTimers:t.target.checked})},n.setStateAndStorage=function(t){n.props.setStateAndStorage(t)},setInterval(n.tick,1e3),n.tick(),n}return Object(l.a)(s,[{key:"formatSecondsAsTimer",value:function(t){return String(Math.floor(t/60)).padStart(2,"0")+":"+String(t%60).padStart(2,"0")}},{key:"formatSecondsAsText",value:function(t){t=Math.round(t);var e=Math.floor(t/3600)+"",s="1"===e?"hour":"hours";t%=3600;var n=Math.floor(t/60)+"",a=(t%=60)%60+"";return e+" "+s+" "+n+" "+("1"===n?"minute":"minutes")+" "+a+" "+("1"===a?"second":"seconds")}},{key:"cyclesUntilLongBreak",get:function(){return this.props.longBreakFreq-this.props.cycle}},{key:"render",value:function(){return Object(k.jsxs)("div",{children:[Object(k.jsx)("div",{class:"row",children:Object(k.jsxs)("div",{class:"col-sm",children:[!0===this.props.timerRunning&&Object(k.jsx)("button",{className:"btn btn-warning",onClick:this.onClickHoldWork,children:"Hold work"}),!1===this.props.timerRunning&&Object(k.jsx)("button",{className:"btn btn-secondary",onClick:this.onClickResumeWork,"data-testid":"resume-work-btn",children:"Resume work"}),null===this.props.isWork&&Object(k.jsx)("button",{className:"btn btn-success",onClick:this.onClickStartWorking,"data-testid":"start-working-btn",children:"Start working"})]})}),Object(k.jsx)("div",{class:"row",children:Object(k.jsx)("div",{class:"col-sm",children:Object(k.jsx)("h1",{"data-testid":"timer",children:this.formatSecondsAsTimer(this.props.timerSeconds)})})}),Object(k.jsx)("div",{class:"row",children:Object(k.jsxs)("div",{class:"col-sm",children:[!0===this.props.isWork&&this.props.availableBreakSeconds?Object(k.jsx)(k.Fragment,{children:Object(k.jsx)("button",{className:"btn btn-success",onClick:this.onClickGoOnABreak,children:"Go on a break"})}):null,!1===this.props.isWork?Object(k.jsx)(k.Fragment,{children:Object(k.jsx)("button",{className:"btn btn-secondary",onClick:this.onClickReturnToWork,children:"Return to work"})}):null]})}),Object(k.jsxs)("div",{class:"row",children:[Object(k.jsx)("div",{class:"col-sm font-weight-light text-md-right",children:"Total time worked:"}),Object(k.jsx)("div",{class:"col-sm text-md-left","data-testid":"totalWorkedTime",children:this.formatSecondsAsText(this.props.totalWorkedSeconds)})]}),Object(k.jsxs)("div",{class:"row",children:[Object(k.jsx)("div",{class:"col-sm font-weight-light text-md-right",children:"Available break time:"}),Object(k.jsx)("div",{class:"col-sm text-md-left","data-testid":"availableBreakTime",children:this.formatSecondsAsText(this.props.availableBreakSeconds)})]}),Object(k.jsxs)("div",{class:"row",children:[Object(k.jsxs)("div",{class:"col-sm font-weight-light text-md-right",children:["Cycles until long break (",this.props.longBreakMinutes," minutes):"]}),Object(k.jsx)("div",{class:"col-sm text-md-left","data-testid":"longBreakInfo",children:this.cyclesUntilLongBreak})]}),Object(k.jsx)("div",{class:"row",children:Object(k.jsx)("div",{class:"col-sm",children:Object(k.jsxs)("div",{class:"form-check",children:[Object(k.jsx)("input",{class:"form-check-input",type:"checkbox",value:"",onChange:this.onChangeContinousWork,checked:this.props.continousWork,"data-testid":"cont-work",id:"cont-work-check"}),Object(k.jsx)("label",{class:"form-check-label",htmlFor:"cont-work-check",children:"Continuous work"})]})})}),Object(k.jsx)("div",{class:"row",children:Object(k.jsx)("div",{class:"col-sm",children:Object(k.jsxs)("div",{class:"form-check",children:[Object(k.jsx)("input",{class:"form-check-input",type:"checkbox",value:"",onChange:this.onChangeAutoStartTimers,checked:this.props.autoStartTimers,"data-testid":"auto-start-timers",id:"auto-start-timers-check"}),Object(k.jsx)("label",{class:"form-check-label",htmlFor:"auto-start-timers-check",children:"Start timers automatically"})]})})})]})}}]),s}(a.a.Component),p=s(14),S=s(10),b=s(8),j=s(15),f=function(){function t(){Object(c.a)(this,t)}return Object(l.a)(t,null,[{key:"CREATE_TASK_PLACEHOLDER_TEXT",get:function(){return"Enter task name..."}},{key:"SAVE_NEW_TASK_BUTTON_TEXT",get:function(){return"Save new task"}}]),t}(),v=function(t){Object(d.a)(s,t);var e=Object(h.a)(s);function s(){var t;Object(c.a)(this,s);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))).handleTextInputChange=function(e){t.setState({taskInput:e.target.value})},t.handleSaveClick=function(){t.props.onTaskCreate(t.state.taskInput)},t.handleTaskSelected=function(e){t.props.onTaskSelected(e.target.value)},t}return Object(l.a)(s,[{key:"render",value:function(){var t=this;return Object(k.jsxs)("div",{children:[Object(k.jsx)("input",{type:"text",onChange:this.handleTextInputChange,placeholder:f.CREATE_TASK_PLACEHOLDER_TEXT}),Object(k.jsx)("button",{onClick:this.handleSaveClick,children:f.SAVE_NEW_TASK_BUTTON_TEXT}),this.props&&this.props.tasks&&this.props.tasks.map((function(e){return Object(k.jsxs)("div",{children:[Object(k.jsx)("input",{type:"radio",id:e,name:"task",value:e,onChange:t.handleTaskSelected}),Object(k.jsx)("label",{htmlFor:e,children:e})]})}))]})}}]),s}(a.a.Component),O=function(t){Object(d.a)(s,t);var e=Object(h.a)(s);function s(t){var n;return Object(c.a)(this,s),(n=e.call(this,t)).onClickReset=function(){window.confirm("Are you sure you want to reset everything to inital state?")&&n.setStateAndStorage(n.getStateForReset())},n.onClickSettings=function(){n.setState({settingsVisible:!n.state.settingsVisible})},n.setStateAndStorage=function(t){n.setState(t),n.storage&&(n.storage.state=Object.assign(n.state,t))},n.onChangeSettings=function(t){n.setStateAndStorage(t)},n.getDefaultState=function(){return{timerSeconds:60*n.defaultSettings.workMinutes,totalWorkedSeconds:0,isWork:null,availableBreakSeconds:0,hiddenAvailableBreakSeconds:0,cycle:0,notificationsGranted:!1,timerRunning:null,continousWork:!1,timerLastUpdatedAt:Date.now(),autoStartTimers:!0,workMinutes:n.defaultSettings.workMinutes,shortBreakMinutes:n.defaultSettings.shortBreakMinutes,longBreakMinutes:n.defaultSettings.longBreakMinutes,longBreakFreq:n.defaultSettings.longBreakFreq,settingsVisible:!1,events:[],timerStartedAt:null,timerStartedWithSeconds:null,tasks:[]}},n.getStateForReset=function(){var t=n.getDefaultState();return t.continousWork=n.state.continousWork,t.autoStartTimers=n.state.autoStartTimers,t.workMinutes=n.state.workMinutes,t.shortBreakMinutes=n.state.shortBreakMinutes,t.longBreakMinutes=n.state.longBreakMinutes,t.longBreakFreq=n.state.longBreakFreq,t.timerSeconds=60*n.state.workMinutes,t.events=n.state.events,t},n.handleTimerStateChange=function(t){t.timerStartedAt<n.state.timerStartedAt&&(t.timerStartedAt=n.state.timerStartedAt),n.setStateAndStorage(t)},n.handleShowNotification=function(t){n.notifications&&n.notificationsGranted&&n.notifications.createNotification(t)},n.handleEventCreated=function(t){var e=t.wasWork?"Work":"Break";void 0!==n.state.selectedTask&&(e+=" ("+n.state.selectedTask+")");var s={title:e,isWork:t.wasWork,start:new Date(t.start),end:new Date(t.end),color:t.wasWork?"#3788d8":"orange",task:n.state.selectedTask};if(s.start.getTime()!==s.end.getTime()){var a=[].concat(Object(o.a)(n.state.events),[s]);a.length>1&&a[a.length-1].isWork===a[a.length-2].isWork&&a[a.length-2].end.getTime()===a[a.length-1].start.getTime()&&a[a.length-1].task===a[a.length-2].task&&((a=a.slice(0,a.length-1))[a.length-1].end=new Date(t.end)),n.setStateAndStorage({events:a})}},n.handleTaskCreated=function(t){var e=n.state.tasks;e.push(t),n.setStateAndStorage({tasks:e})},n.handleTaskSelected=function(t){var e=n.state.selectedTask,s=n.state.timerStartedAt+1e3*(n.state.timerStartedWithSeconds-n.state.timerSeconds);void 0!==e&&n.handleEventCreated({wasWork:n.state.isWork,start:n.state.timerStartedAt,end:s}),n.setStateAndStorage({timerStartedAt:s,timerStartedWithSeconds:n.state.timerSeconds,selectedTask:t})},n.defaultSettings=t.defaultSettings,n.storage=t.storage,n.state=n.getDefaultState(),n.storage&&n.storage.state&&(n.state=Object.assign(n.state,n.storage.state),n.state.events.forEach((function(t){t.start=new Date(Date.parse(t.start)),t.end=new Date(Date.parse(t.end))}))),t.notifications&&(n.notifications=t.notifications,n.notifications.requestPermission().then((function(t){"granted"===t&&(n.notificationsGranted=!0)}))),n.plugins=[S.a],n}return Object(l.a)(s,[{key:"render",value:function(){return Object(k.jsxs)("div",{className:"App",children:[Object(k.jsx)(u.Helmet,{children:Object(k.jsx)("title",{children:"Timer"})}),Object(k.jsx)("link",{rel:"stylesheet",href:"https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css",integrity:"sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T",crossOrigin:"anonymous"}),Object(k.jsx)("script",{src:"https://code.jquery.com/jquery-3.3.1.slim.min.js",integrity:"sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo",crossOrigin:"anonymous"}),Object(k.jsx)("script",{src:"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js",integrity:"sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1",crossOrigin:"anonymous"}),Object(k.jsx)("script",{src:"https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js",integrity:"sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM",crossOrigin:"anonymous"}),Object(k.jsxs)("div",{className:"container",children:[Object(k.jsx)("div",{className:"row",children:Object(k.jsx)("div",{className:"col-sm offset-sm-11",children:Object(k.jsx)("button",{className:"btn",onClick:this.onClickReset,"data-testid":"reset-btn",children:"Reset"})})}),Object(k.jsx)(g,{timerSeconds:this.state.timerSeconds,totalWorkedSeconds:this.state.totalWorkedSeconds,isWork:this.state.isWork,availableBreakSeconds:this.state.availableBreakSeconds,hiddenAvailableBreakSeconds:this.state.hiddenAvailableBreakSeconds,cycle:this.state.cycle,timerRunning:this.state.timerRunning,continousWork:this.state.continousWork,timerLastUpdatedAt:this.state.timerLastUpdatedAt,autoStartTimers:this.state.autoStartTimers,workMinutes:this.state.workMinutes,shortBreakMinutes:this.state.shortBreakMinutes,longBreakMinutes:this.state.longBreakMinutes,longBreakFreq:this.state.longBreakFreq,timerStartedAt:this.state.timerStartedAt,timerStartedWithSeconds:this.state.timerStartedWithSeconds,setStateAndStorage:this.handleTimerStateChange,showNotification:this.handleShowNotification,onTimerFinish:this.handleEventCreated}),Object(k.jsx)("button",{className:"btn m-2",type:"button",onClick:this.onClickSettings,children:"Settings"}),Object(k.jsx)("div",{className:this.state.settingsVisible?"collapse show":"collapse",children:Object(k.jsx)("div",{className:"card card-body row",children:Object(k.jsx)(m,{workMinutes:this.state.workMinutes,shortBreakMinutes:this.state.shortBreakMinutes,longBreakMinutes:this.state.longBreakMinutes,longBreakFreq:this.state.longBreakFreq,onchange:this.onChangeSettings})})}),Object(k.jsx)("div",{className:"row",children:Object(k.jsx)(v,{onTaskCreate:this.handleTaskCreated,onTaskSelected:this.handleTaskSelected,tasks:this.state.tasks})}),Object(k.jsx)("div",{className:"card card-body",children:Object(k.jsx)(p.a,{events:this.state.events,plugins:[S.a,b.b,j.a],initialView:"timeGridWeek",headerToolbar:{right:"today prev,next dayGridMonth,timeGridWeek,timeGridDay listWeek"},slotDuration:"00:15:00"})})]})]})}}]),s}(a.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var x=function(t){Object(d.a)(s,t);var e=Object(h.a)(s);function s(){return Object(c.a)(this,s),e.call(this,25,5,10,4,480)}return s}(function(){function t(e,s,n,a){Object(c.a)(this,t),this._workMinutes=e,this._shortBreakMinutes=s,this._longBreakMinutes=n,this._longBreakFreq=a}return Object(l.a)(t,[{key:"workMinutes",get:function(){return this._workMinutes}},{key:"shortBreakMinutes",get:function(){return this._shortBreakMinutes}},{key:"longBreakMinutes",get:function(){return this._longBreakMinutes}},{key:"longBreakFreq",get:function(){return this._longBreakFreq}}]),t}()),B=function(){function t(){Object(c.a)(this,t)}return Object(l.a)(t,[{key:"requestPermission",value:function(){return Notification.requestPermission()}},{key:"createNotification",value:function(t,e){new Notification(t,e)}}]),t}(),w=function(){function t(){Object(c.a)(this,t)}return Object(l.a)(t,[{key:"state",get:function(){return JSON.parse(localStorage.getItem("timer_state"))},set:function(t){localStorage.setItem("timer_state",JSON.stringify(t))}}]),t}();i.a.render(Object(k.jsx)(O,{basename:"/cooltimer",defaultSettings:new x,notifications:new B,storage:new w}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[35,1,2]]]);
//# sourceMappingURL=main.56019dcc.chunk.js.map